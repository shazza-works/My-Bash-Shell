#if 0
	shc Version 3.9.6, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -r -f git-update3.sh -o gitupdate 
#endif

static  char data [] = 
#define      shll_z	10
#define      shll	((&data[1]))
	"\030\131\071\147\300\346\266\336\235\022\037\113"
#define      chk2_z	19
#define      chk2	((&data[16]))
	"\210\035\152\211\001\304\370\167\347\143\065\307\163\024\215\275"
	"\070\243\026\343\323\224\017\257\242"
#define      pswd_z	256
#define      pswd	((&data[99]))
	"\060\211\000\176\361\325\213\070\337\067\162\006\125\051\072\314"
	"\234\122\030\223\056\206\034\113\361\245\373\224\244\362\326\325"
	"\173\326\123\155\254\336\246\214\026\030\223\153\102\315\070\336"
	"\040\121\162\117\330\216\233\311\064\226\136\331\210\064\230\003"
	"\102\165\007\326\067\366\134\371\205\234\353\240\211\323\330\371"
	"\024\206\114\230\227\317\040\054\254\362\115\232\003\345\235\106"
	"\133\245\034\223\233\170\214\041\024\170\301\236\113\231\230\140"
	"\037\344\371\266\263\032\342\140\015\057\372\020\025\230\126\161"
	"\075\163\005\331\354\221\372\001\012\274\240\126\125\070\266\165"
	"\035\257\054\321\312\016\061\327\076\054\350\124\304\077\305\002"
	"\262\312\334\237\134\327\240\147\223\100\275\351\171\164\136\226"
	"\044\212\147\356\231\230\305\330\305\256\055\212\355\363\215\237"
	"\276\151\076\032\100\337\202\323\040\100\274\231\264\033\057\331"
	"\246\226\310\077\057\216\030\364\074\105\176\051\070\013\311\366"
	"\165\007\021\265\347\224\210\007\324\105\240\211\140\317\142\006"
	"\146\053\106\225\271\137\212\365\244\010\037\335\024\350\324\211"
	"\357\346\077\327\172\307\336\117\015\177\330\156\117\073\165\265"
	"\146\274\113\040\033\325\025\300\336\064\235\363\035\162\174\014"
	"\131\274\344\323\204\303\043\221\102\374\000\221\067\165\107\236"
	"\061\222\277\115\150\325\015\106\011\253\071\047\036\266\256\004"
	"\013\001\162\270\340\030\104\366\060\327\142\162\245\233"
#define      inlo_z	3
#define      inlo	((&data[371]))
	"\265\036\103"
#define      opts_z	1
#define      opts	((&data[374]))
	"\130"
#define      xecc_z	15
#define      xecc	((&data[377]))
	"\207\107\021\153\223\342\211\166\325\345\354\043\310\223\151\351"
	"\130\354\140"
#define      text_z	3390
#define      text	((&data[504]))
	"\324\054\020\107\345\360\137\051\346\220\001\110\003\247\344\124"
	"\156\320\030\204\224\153\065\043\363\174\020\123\114\061\142\041"
	"\136\162\150\103\142\310\155\111\130\156\222\133\026\166\260\204"
	"\107\310\010\334\064\075\377\047\272\017\173\007\101\336\051\237"
	"\120\221\343\263\132\120\375\262\277\217\015\325\006\275\132\115"
	"\206\142\051\272\240\051\342\132\070\136\141\171\074\212\031\215"
	"\034\374\101\166\114\076\051\014\316\067\341\324\365\074\324\041"
	"\064\252\115\176\326\226\046\143\050\060\212\175\124\260\126\317"
	"\037\164\165\156\316\057\326\217\372\255\356\322\234\230\052\260"
	"\275\172\075\053\162\103\200\315\334\267\152\152\147\311\346\263"
	"\347\343\324\036\154\243\150\004\135\261\210\111\154\067\270\377"
	"\373\173\121\113\225\215\226\025\205\030\317\102\363\345\350\366"
	"\011\225\355\314\317\264\066\327\207\052\010\347\175\252\376\264"
	"\073\333\335\047\172\130\275\045\120\232\335\100\130\256\253\350"
	"\067\332\071\027\201\152\323\277\364\201\356\002\327\170\002\364"
	"\245\236\227\004\124\042\274\062\235\014\231\136\334\225\111\340"
	"\376\334\200\060\371\362\232\106\341\337\306\075\363\330\050\216"
	"\255\242\042\165\104\120\344\157\351\374\104\126\075\126\044\012"
	"\240\145\165\200\037\033\167\277\301\374\254\114\121\311\054\003"
	"\366\317\070\152\014\022\302\247\270\013\377\160\042\114\205\222"
	"\306\276\306\330\373\354\360\164\107\127\260\060\345\104\362\053"
	"\330\225\263\304\274\373\105\042\264\254\164\103\263\035\043\364"
	"\350\074\136\304\076\110\033\373\212\265\245\323\337\005\037\350"
	"\301\203\145\210\145\251\215\316\100\232\131\051\337\234\131\302"
	"\374\011\135\347\137\371\122\071\210\025\262\275\120\056\007\133"
	"\336\223\016\124\172\327\365\162\361\335\137\111\236\057\336\322"
	"\346\066\123\263\000\256\132\302\105\245\117\126\255\160\350\140"
	"\217\053\307\274\237\331\021\107\025\166\220\100\050\261\163\075"
	"\270\011\056\030\355\057\370\354\232\146\164\121\336\007\173\044"
	"\333\114\030\157\325\074\164\067\264\215\370\216\221\264\211\252"
	"\261\235\037\324\121\365\253\137\120\254\140\044\137\056\044\057"
	"\022\053\377\376\144\206\024\105\017\045\135\126\176\255\102\211"
	"\367\237\274\000\117\262\100\205\230\176\047\042\042\212\304\315"
	"\254\344\325\331\127\207\065\372\012\321\077\255\063\261\351\340"
	"\204\003\376\131\045\004\043\010\254\021\012\077\063\130\372\066"
	"\012\257\072\175\055\312\153\245\136\246\104\012\102\010\137\030"
	"\271\346\170\006\175\005\032\342\046\052\014\200\163\072\131\156"
	"\061\101\021\214\011\240\326\266\267\064\042\066\354\215\224\346"
	"\303\155\175\065\370\202\273\372\011\003\341\153\310\151\117\227"
	"\111\134\063\247\074\075\366\026\101\006\257\342\060\123\236\222"
	"\100\175\163\032\175\174\316\262\246\105\016\016\045\265\236\304"
	"\235\147\257\156\111\143\276\170\113\231\014\035\344\106\301\004"
	"\240\014\030\131\353\227\101\373\373\356\351\175\011\207\351\201"
	"\153\154\276\353\016\053\061\076\101\100\220\356\242\013\263\160"
	"\363\145\010\145\132\350\067\016\224\167\305\046\216\023\220\162"
	"\176\225\030\052\037\161\351\341\077\233\177\222\340\073\123\344"
	"\131\174\065\133\063\222\345\335\146\142\251\142\034\202\031\203"
	"\311\007\327\042\065\232\051\332\104\331\114\343\007\272\355\375"
	"\356\064\054\243\220\006\060\365\153\104\217\040\314\154\041\217"
	"\245\120\025\133\175\047\355\014\173\132\233\242\062\235\123\240"
	"\366\267\343\341\113\126\152\304\144\300\340\100\165\070\314\037"
	"\074\327\003\017\245\246\066\347\051\133\313\107\220\005\374\167"
	"\066\352\374\330\010\315\062\062\342\136\026\165\377\275\165\131"
	"\026\013\365\331\047\372\141\271\067\003\365\103\143\242\337\263"
	"\146\145\346\203\265\347\167\364\122\310\325\302\171\242\230\221"
	"\370\266\065\021\371\336\022\105\052\352\016\125\037\100\054\143"
	"\044\253\030\257\112\010\077\175\347\351\276\353\126\132\232\026"
	"\073\144\324\130\344\342\243\130\225\262\252\057\366\067\072\040"
	"\071\362\220\344\145\350\042\232\056\304\206\024\024\271\056\372"
	"\365\327\275\264\175\156\123\331\151\274\023\121\212\343\226\116"
	"\104\104\070\314\174\136\065\150\056\110\267\041\213\040\153\156"
	"\362\234\131\107\366\166\202\371\232\230\163\255\302\237\216\027"
	"\201\322\173\275\216\173\270\323\335\007\357\330\155\116\120\012"
	"\133\030\006\155\376\215\250\051\213\172\100\016\342\132\363\016"
	"\244\064\240\056\367\172\270\301\327\136\137\175\031\202\337\200"
	"\153\257\161\016\127\241\033\151\320\140\347\265\163\355\313\311"
	"\234\051\104\022\043\105\231\345\235\036\240\155\357\267\040\044"
	"\214\346\112\035\360\114\024\030\207\120\175\356\014\353\157\362"
	"\236\137\070\067\152\167\242\340\105\235\231\150\245\341\321\337"
	"\241\211\343\133\373\320\233\277\274\060\117\312\205\134\043\024"
	"\367\220\007\125\337\225\230\263\222\333\355\033\245\104\247\135"
	"\112\247\206\250\141\346\347\275\324\116\345\110\106\136\262\223"
	"\063\345\265\064\256\044\020\043\224\337\104\341\161\111\222\040"
	"\211\317\371\007\240\246\272\322\353\060\175\113\064\053\243\360"
	"\242\267\100\272\000\033\115\013\344\256\117\111\053\047\352\026"
	"\377\002\220\335\275\150\022\211\150\167\166\276\227\027\320\275"
	"\127\301\215\073\263\053\222\253\031\016\160\036\322\042\264\307"
	"\270\204\203\152\337\107\210\105\130\346\214\344\204\071\055\363"
	"\331\216\372\210\067\303\315\107\053\112\366\131\267\140\337\160"
	"\042\050\010\200\221\046\227\376\246\170\056\134\233\271\042\353"
	"\240\126\141\231\330\221\210\261\235\323\000\123\054\301\375\073"
	"\251\040\124\025\301\156\137\340\346\363\310\046\174\203\145\002"
	"\343\251\254\142\274\037\004\167\174\112\103\116\047\322\250\122"
	"\053\314\125\375\157\025\167\033\216\232\211\335\242\103\215\344"
	"\205\241\300\041\344\311\024\221\042\063\324\024\030\155\376\224"
	"\326\162\206\002\053\373\323\117\154\006\144\301\356\254\202\262"
	"\144\156\340\331\037\121\224\233\157\034\170\304\124\326\024\330"
	"\250\021\107\010\053\301\135\150\010\051\343\004\070\356\302\202"
	"\364\217\250\023\000\010\150\076\307\273\265\213\154\003\154\242"
	"\157\047\132\272\331\072\157\176\277\155\164\220\024\213\003\350"
	"\200\005\124\102\267\273\116\330\271\136\176\267\161\052\344\117"
	"\216\241\202\375\330\165\252\127\032\213\072\372\076\156\162\324"
	"\042\374\067\226\034\017\052\003\070\211\225\071\321\042\062\233"
	"\276\344\335\107\164\160\332\310\062\306\233\235\204\373\274\247"
	"\374\024\127\313\215\074\310\000\313\271\167\033\155\054\272\122"
	"\210\352\115\130\311\143\131\362\370\267\314\223\243\063\151\123"
	"\035\002\052\032\272\222\370\216\024\040\254\361\216\051\344\207"
	"\225\101\231\160\336\374\112\116\143\142\323\336\064\143\310\373"
	"\027\110\074\345\205\370\277\353\127\305\324\040\200\374\157\035"
	"\075\143\100\200\246\044\342\344\061\363\137\000\035\364\225\341"
	"\221\002\160\000\376\065\051\256\014\377\324\257\175\346\157\270"
	"\333\056\061\174\031\143\151\304\006\071\152\051\103\301\372\274"
	"\015\267\350\130\013\373\246\170\316\252\273\165\213\205\101\105"
	"\261\271\122\060\171\023\163\101\164\132\067\040\360\035\366\267"
	"\340\123\002\212\162\021\023\021\170\017\246\155\174\276\217\200"
	"\335\112\047\371\343\012\304\206\241\132\025\025\244\354\125\013"
	"\214\275\011\157\122\254\032\362\272\150\327\115\067\030\136\045"
	"\226\252\017\072\242\102\150\023\247\354\317\057\321\147\241\202"
	"\276\002\236\046\071\242\024\310\320\205\271\133\250\136\275\231"
	"\210\255\300\014\052\241\116\015\125\130\371\306\370\210\204\020"
	"\171\067\126\306\015\036\045\227\044\170\063\330\206\172\312\201"
	"\067\130\220\143\067\323\204\142\207\352\352\157\250\243\112\316"
	"\066\126\106\134\334\124\144\345\017\344\222\354\143\321\370\122"
	"\101\154\026\162\137\112\153\030\033\327\100\035\103\172\233\077"
	"\241\256\311\061\272\061\040\147\263\171\011\211\106\126\122\134"
	"\106\053\272\257\230\013\346\173\114\341\042\126\217\150\163\114"
	"\343\047\247\146\236\146\256\202\107\006\134\331\160\266\155\243"
	"\332\374\272\217\066\264\220\255\150\054\134\227\312\272\377\150"
	"\255\122\013\277\267\044\200\170\311\017\200\277\145\071\165\360"
	"\111\114\270\210\204\332\144\126\257\121\355\010\356\210\034\254"
	"\131\157\042\334\271\312\052\352\230\277\235\220\303\241\363\025"
	"\165\036\127\100\322\171\331\371\027\216\351\073\165\027\215\142"
	"\077\015\312\277\135\332\022\172\221\325\241\241\221\076\250\243"
	"\317\162\165\201\227\244\371\161\305\263\216\076\214\213\363\327"
	"\337\030\143\131\371\353\352\016\107\376\140\017\227\010\007\140"
	"\134\300\051\146\344\304\131\073\232\265\063\343\067\044\141\341"
	"\247\233\130\076\176\033\025\051\101\021\026\173\027\274\032\310"
	"\375\147\106\351\324\124\305\375\153\330\062\314\207\214\135\365"
	"\162\346\361\217\320\253\023\056\205\250\203\351\136\165\303\274"
	"\354\253\335\277\150\162\351\266\375\057\001\220\060\041\335\047"
	"\201\170\320\354\001\040\343\022\370\244\006\325\323\077\114\032"
	"\153\204\202\030\126\300\345\017\276\350\367\044\131\252\175\200"
	"\051\074\217\356\007\170\112\102\162\105\321\164\340\240\217\223"
	"\213\114\015\316\011\220\122\074\366\227\127\211\136\213\017\325"
	"\016\024\064\061\137\204\202\342\151\303\256\217\031\336\066\373"
	"\250\352\113\324\214\351\171\350\340\037\073\344\347\040\011\006"
	"\270\363\206\310\217\216\073\261\060\234\026\265\116\033\274\274"
	"\353\342\322\305\232\366\341\272\067\141\173\252\011\357\037\045"
	"\113\207\011\361\001\204\173\271\372\215\214\140\334\054\114\064"
	"\155\023\042\175\355\201\266\176\257\145\217\312\037\140\105\077"
	"\051\300\312\007\014\220\154\177\345\073\245\347\160\003\321\225"
	"\164\365\335\160\042\127\356\355\235\301\175\307\225\026\045\264"
	"\251\207\130\035\231\020\247\106\211\033\344\342\067\016\172\077"
	"\264\064\277\063\176\132\260\301\035\173\162\071\364\206\011\012"
	"\130\166\153\013\254\325\367\213\113\334\225\130\103\331\112\321"
	"\125\130\352\375\216\107\360\143\155\265\256\061\164\312\206\372"
	"\074\100\062\355\355\233\266\134\260\072\355\324\121\130\251\222"
	"\160\205\016\250\147\160\056\330\254\353\100\035\265\003\107\315"
	"\113\063\200\100\132\301\103\177\072\141\146\032\067\004\063\024"
	"\161\032\272\111\307\016\346\214\246\224\341\201\355\261\264\241"
	"\030\215\257\375\173\176\116\316\142\352\132\274\317\162\060\277"
	"\363\264\230\151\243\057\112\373\061\141\077\136\062\040\155\353"
	"\203\130\245\244\272\300\354\304\173\310\142\156\357\154\143\075"
	"\162\040\224\041\230\127\256\007\122\012\013\162\051\307\127\361"
	"\332\346\304\046\162\001\020\312\277\062\326\066\002\211\305\221"
	"\201\236\163\351\273\025\155\330\356\347\133\207\361\345\064\055"
	"\232\315\353\363\214\340\261\012\134\351\214\136\301\067\060\217"
	"\252\023\315\127\065\252\012\223\343\007\274\211\015\304\013\347"
	"\226\150\206\373\355\044\017\067\364\342\355\051\230\366\273\334"
	"\271\354\363\254\053\212\232\115\317\037\033\201\244\235\264\131"
	"\173\372\276\021\212\002\056\013\347\177\314\166\142\366\267\037"
	"\055\333\247\263\301\342\373\002\332\150\077\153\232\360\104\160"
	"\356\214\037\013\234\064\316\337\301\064\244\320\014\027\231\363"
	"\370\135\341\141\176\205\323\324\154\207\003\163\202\211\032\371"
	"\305\330\242\171\211\121\350\030\370\003\140\117\034\200\213\016"
	"\332\124\320\036\001\002\270\360\376\140\307\062\041\335\201\032"
	"\136\304\146\312\107\146\042\365\335\041\201\000\317\165\005\052"
	"\044\255\137\047\354\147\342\072\222\344\317\267\115\167\300\051"
	"\071\012\326\017\262\221\135\061\350\351\311\044\342\225\036\325"
	"\264\147\210\145\057\065\164\253\160\022\076\031\201\106\337\322"
	"\150\245\366\052\110\246\032\344\154\012\320\266\107\021\137\062"
	"\160\076\116\065\257\316\307\171\222\147\306\032\265\073\011\356"
	"\052\143\313\333\327\251\156\250\154\320\373\242\335\273\231\142"
	"\134\006\117\266\125\066\033\352\311\320\305\155\010\341\165\031"
	"\141\077\031\275\140\347\007\354\030\035\012\371\143\016\072\126"
	"\055\026\305\351\254\101\032\147\327\243\072\151\025\123\004\040"
	"\147\131\037\314\246\224\035\017\205\174\041\341\306\246\144\200"
	"\270\240\122\200\367\106\000\000\243\300\126\124\267\153\110\167"
	"\056\046\054\376\366\204\062\236\344\155\062\326\252\017\262\255"
	"\365\121\017\302\244\154\044\231\326\234\043\051\227\121\247\274"
	"\361\210\336\275\312\303\233\230\270\133\201\307\341\247\160\273"
	"\123\223\144\242\322\131\375\075\344\111\057\310\262\224\020\165"
	"\273\306\277\110\255\066\261\173\165\246\060\375\071\130\256\104"
	"\221\156\116\255\254\211\170\103\266\305\325\054\167\211\366\214"
	"\346\236\173\101\264\152\210\327\134\043\372\220\263\343\201\141"
	"\300\053\120\140\164\032\113\154\133\312\071\307\375\030\345\163"
	"\347\250\176\222\256\107\230\147\276\122\110\162\373\220\372\257"
	"\302\052\150\250\252\103\152\005\342\143\324\246\352\030\011\254"
	"\064\331\125\040\352\351\331\131\071\154\146\157\233\303\041\270"
	"\262\020\050\042\355\163\156\220\253\104\254\021\030\060\364\355"
	"\100\102\335\101\020\072\007\004\142\135\247\121\070\162\115\011"
	"\163\367\124\231\131\237\006\360\251\320\235\055\000\040\060\134"
	"\320\026\257\066\040\274\252\307\001\201\203\260\164\166\364\172"
	"\133\160\007\332\227\102\210\257\045\317\110\016\014\373\307\304"
	"\267\107\125\270\063\352\362\071\221\275\005\145\315\005\376\031"
	"\052\270\225\024\011\275\364\243\017\331\350\062\005\015\303\356"
	"\051\102\353\332\156\360\054\126\256\042\020\102\351\015\371\233"
	"\020\240\332\214\064\131\001\251\350\342\342\207\300\065\041\307"
	"\241\252\061\154\304\203\251\053\013\226\256\234\310\270\150\265"
	"\353\121\313\041\051\126\352\124\017\105\137\152\224\203\215\175"
	"\274\034\363\300\276\262\153\301\313\171\225\325\345\305\324\240"
	"\374\237\117\233\345\123\067\216\253\372\046\215\077\270\164\100"
	"\364\222\377\064\372\231\040\245\134\024\333\073\012\046\053\146"
	"\045\362\156\051\262\100\132\241\140\336\364\212\147\325\067\215"
	"\313\070\164\251\027\116\126\220\336\134\112\312\066\374\046\237"
	"\021\371\261\223\366\374\075\305\126\003\230\262\243\035\315\143"
	"\004\270\276\152\361\145\116\357\211\023\273\174\231\236\035\130"
	"\046\152\210\340\300\176\366\127\111\023\345\042\132\006\001\137"
	"\332\120\204\146\257\356\233\253\162\025\324\140\124\122\301\146"
	"\030\255\121\343\151\241\324\253\262\170\071\214\102\202\153\263"
	"\217\332\240\373\146\155\240\252\335\212\327\347\146\012\117\046"
	"\255\302\161\213\111\004\041\221\325\133\311\357\135\222\264\033"
	"\212\350\241\220\375\166\250\321\220\203\006\223\061\021\026\366"
	"\120\314\016\366\146\111\171\130\106\262\375\204\224\213\104\303"
	"\270\372\026\072\302\034\271\122\103\127\152\210\000\130\363\342"
	"\270\230\256\313\234\216\243\042\174\217\373\035\214\227\253\230"
	"\004\142\324\030\375\203\046\046\013\005\372\077\014\374\121\201"
	"\334\224\275\131\123\236\321\171\301\204\231\275\344\165\045\106"
	"\323\227\057\325\356\237\023\205\014\153\113\211\041\173\237\113"
	"\066\077\164\031\231\254\167\373\046\263\206\077\101\243\073\202"
	"\032\210\300\103\224\216\172\166\143\160\262\205\353\121\320\042"
	"\221\104\073\053\361\262\046\030\146\255\130\247"
#define      lsto_z	1
#define      lsto	((&data[3942]))
	"\245"
#define      tst1_z	22
#define      tst1	((&data[3943]))
	"\176\174\025\120\066\176\274\141\327\172\203\347\337\273\004\363"
	"\117\257\052\062\065\147\256\261\171\051\047"
#define      tst2_z	19
#define      tst2	((&data[3972]))
	"\142\205\165\331\300\277\351\062\304\201\053\202\100\026\114\077"
	"\045\242\151\226\335\054\062\247\275"
#define      chk1_z	22
#define      chk1	((&data[4000]))
	"\151\226\017\202\374\324\060\315\366\106\127\036\167\013\062\116"
	"\370\343\044\242\163\206\176\161\235\027\344\275\332\244\015\156"
#define      msg1_z	65
#define      msg1	((&data[4035]))
	"\271\047\075\063\120\144\020\352\173\353\177\225\377\175\346\272"
	"\156\045\111\152\226\343\044\217\357\306\002\173\356\044\201\174"
	"\135\224\072\275\322\233\036\142\064\017\371\027\205\237\223\327"
	"\340\276\242\240\045\121\302\230\114\116\060\014\116\034\154\052"
	"\205\247\264\046\012\327\040\025\207\077\162\157\154\245\026\051"
	"\035\371"
#define      date_z	1
#define      date	((&data[4109]))
	"\257"
#define      msg2_z	19
#define      msg2	((&data[4110]))
	"\345\156\364\343\074\262\231\140\123\221\374\165\235\031\072\304"
	"\214\235\110\340\343"
#define      rlax_z	1
#define      rlax	((&data[4131]))
	"\056"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
